<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù…Ù†ÙŠÙˆ ÙˆØ±Ø¯ ÙƒØ§ÙÙŠÙ‡</title>
  <link rel="icon" href="photos/logo.png" type="image/x-icon">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#551665">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="photos/logo.png">

  <style>
    /* Ø¯Ù…Ø¬ Ù…Ø­ØªÙˆÙŠØ§Øª style.css Ù‡Ù†Ø§ */
    body {
      margin: 0;
      padding-bottom: 100px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #fff9ec;
      color: #333;
    }

    .page-frame {
      border: 5px solid #551665;
      border-radius: 20px;
      margin: 10px;
      padding: 0;
      box-sizing: border-box;
      min-height: calc(100vh - 20px);
      background: #fff;
    }

    .header {
      background: #551665;
      color: white;
      padding: 8px 1%;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      margin-bottom: 10px;
      position: relative;
      overflow: hidden;
      min-height: 200px;
    }

    .logo-img, .logo-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 0;
      animation: flash-display 20s infinite ease-in-out;
      text-align: center;
      max-width: 90%;
    }

    .logo-img { animation-delay: 0s; }
    .logo-text { animation-delay: 10s; font-size: 14px; line-height: 1.6; }

    @keyframes flash-display {
      0%, 45% { opacity: 1; z-index: 2; }
      50%, 95% { opacity: 0; z-index: 1; }
      100% { opacity: 1; }
    }

    .search-bar {
      margin: 15px;
      display: flex;
      background: #e6e3da;
      border-radius: 12px;
      padding: 5px 15px;
      align-items: center;
    }

    .search-bar input {
      flex: 1;
      border: none;
      background: transparent;
      outline: none;
      font-size: 16px;
      padding: 8px;
    }

    .categories-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      padding: 10px;
      background: #fff9ec;
    }

    .category {
      background: #e6e3da;
      border: none;
      padding: 10px 5px;
      border-radius: 12px;
      text-align: center;
      font-size: 12px;
      cursor: pointer;
      transition: 0.3s;
    }

    .category.selected {
      background: linear-gradient(135deg,#8E44AD,#551665);
      color: white;
    }

    .food-card {
      margin: 15px;
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      border: 1px solid #eee;
    }

    .food-card img { width: 100%; height: auto; display: block; }
    .food-info { padding: 15px; text-align: right; }
    .food-info h4 { margin: 0; font-size: 16px; display: flex; justify-content: space-between; }
    .food-info p { font-size: 13px; color: #777; margin: 8px 0 0 0; }

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠØ© - ØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„ÙÙˆÙ†Øª Ø£ÙˆØ³Ù… Ø¨Ø¥ÙŠÙ…ÙˆØ¬ÙŠ */
    .bottom-nav {
      display: flex;
      justify-content: space-around;
      align-items: center;
      background: #551665;
      padding: 12px 0;
      border-radius: 25px;
      position: fixed;
      bottom: 15px;
      width: 90%;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
    }

    .bottom-nav a {
      color: white;
      font-size: 24px;
      text-decoration: none;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .bottom-nav span { font-size: 10px; margin-top: 4px; }

    /* Ø²Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ø¹Ø§Ø¦Ù… */
    .home-btn {
      position: absolute;
      right: 12px;
      bottom: 12px;
      background: linear-gradient(135deg,#8E44AD, #551665);
      color: white;
      padding: 8px 15px;
      border-radius: 10px;
      text-decoration: none;
      font-size: 14px;
      z-index: 100;
    }

    /* Ù„ÙˆØ¯Ø± Ø¨Ø³ÙŠØ· Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    #loading-state { text-align: center; padding: 20px; color: #551665; font-weight: bold; }
  </style>
</head>

<body>

  <div class="page-frame">
    <div class="header">
      <img src="photos/logo.png" alt="Logo" class="logo-img">
      <div class="logo-text">
        Ù…Ø·Ø¹Ù… ÙˆÙƒØ§ÙÙŠÙ‡ "ÙˆØ±Ø¯"<br>
        Ø·Ø¹Ø§Ù… ØµØ­ÙŠ Ø¨Ù…ÙƒÙˆÙ†Ø§Øª Ø·Ø¨ÙŠØ¹ÙŠØ© Ø·Ø§Ø²Ø¬Ø©.<br>
        ØµÙˆØ± Ø£Ø·Ø¨Ø§Ù‚Ù†Ø§ ÙˆØ§Ù‚Ø¹ÙŠØ© ÙƒÙ…Ø§ ØªÙÙ‚Ø¯ÙÙ‘Ù….
      </div>
      <a href="index.html" class="home-btn">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    </div>

    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙˆØ¬Ø¨Ø© Ø£Ùˆ Ø³Ø¹Ø±..." oninput="search()">
      <span>ğŸ”</span>
    </div>

    <div class="categories-grid">
      <button class="category selected" onclick="filterCat(this, 'Ø§Ù„Ø§ÙØ·Ø§Ø±')">ğŸ¥—<br>Ø§Ù„Ø§ÙØ·Ø§Ø±</button>
      <button class="category" onclick="filterCat(this, 'Ø³Ø§Ù†Ø¯ÙˆÙŠØªØ´')">ğŸ¥ª<br>Ø³Ø§Ù†Ø¯ÙˆÙŠØªØ´</button>
      <button class="category" onclick="filterCat(this, 'Ø§Ù„Ø¨ÙŠØªØ²Ø§')">ğŸ•<br>Ø§Ù„Ø¨ÙŠØªØ²Ø§</button>
      <button class="category" onclick="filterCat(this, 'Ø§Ù„Ø§Ø·Ø¨Ø§Ù‚')">ğŸ½ï¸<br>Ø§Ù„Ø§Ø·Ø¨Ø§Ù‚</button>
      <button class="category" onclick="filterCat(this, 'Ø§Ù„Ø­Ù„ÙˆÙŠØ§Øª')">ğŸ°<br>Ø­Ù„ÙˆÙŠØ§Øª</button>
      <button class="category" onclick="filterCat(this, 'Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ø§Ù„Ø¨Ø§Ø±Ø¯Ø©')">ğŸ¥¤<br>Ø¨Ø§Ø±Ø¯</button>
      <button class="category" onclick="filterCat(this, 'Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ø§Ù„Ø³Ø§Ø®Ù†Ø©')">â˜•<br>Ø³Ø§Ø®Ù†</button>
      <button class="category" onclick="filterCat(this, 'Ø³Ù†Ø§Ùƒ')">ğŸ¥¨<br>Ø³Ù†Ø§Ùƒ</button>
    </div>

    <div id="loading-state">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡ÙŠ... ğŸŒ¸</div>
    <div id="food-list"></div>
  </div>

  <nav class="bottom-nav">
    <a href="fedback.html">ğŸ’¬<span>Ø¢Ø±Ø§Ø¦ÙƒÙ…</span></a>
    <a href="index.html">ğŸ <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></a>
    <a href="map.html">ğŸ“<span>Ù…ÙˆÙ‚Ø¹Ù†Ø§</span></a>
  </nav>

<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwF6QRoxTgFhZiU1fkCIOkUiIsbnNfH5rRufLxz5bg8HhnCJcjs675LZI4gtarBFgRB/exec";
  let foodData = {};

  async function loadMenu() {
    const cache = localStorage.getItem('ward_menu_cache');
    if (cache) {
      foodData = JSON.parse(cache);
      render('Ø§Ù„Ø§ÙØ·Ø§Ø±');
      document.getElementById('loading-state').style.display = 'none';
    }

    try {
      const res = await fetch(`${SCRIPT_URL}?action=read`);
      const data = await res.json();
      
      // ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      const organized = {};
      data.forEach(item => {
        if (!organized[item.category]) organized[item.category] = [];
        organized[item.category].push(item);
      });

      foodData = organized;
      localStorage.setItem('ward_menu_cache', JSON.stringify(organized));
      if (!cache) render('Ø§Ù„Ø§ÙØ·Ø§Ø±');
      document.getElementById('loading-state').style.display = 'none';
    } catch (e) {
      console.log("Error loading data");
    }
  }

  function render(cat) {
    const container = document.getElementById('food-list');
    container.innerHTML = '';
    const items = foodData[cat] || [];

    items.forEach(item => {
      const card = document.createElement('div');
      card.className = 'food-card';
      card.innerHTML = `
        ${item.image ? `<img src="${item.image}" loading="lazy" onerror="this.style.display='none'">` : ''}
        <div class="food-info">
          <h4><span>${item.name}</span> <span style="color:#551665">${item.price} Ø±.ÙŠ</span></h4>
          ${item.description ? `<p>${item.description}</p>` : ''}
        </div>
      `;
      container.appendChild(card);
    });
  }

  function filterCat(btn, cat) {
    document.querySelectorAll('.category').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
    render(cat);
  }

  function search() {
    const q = document.getElementById('searchInput').value.toLowerCase();
    const container = document.getElementById('food-list');
    container.innerHTML = '';
    
    Object.values(foodData).flat().forEach(item => {
      if (item.name.toLowerCase().includes(q)) {
        const card = document.createElement('div');
        card.className = 'food-card';
        card.innerHTML = `<div class="food-info"><h4>${item.name} <span>${item.price}</span></h4></div>`;
        container.appendChild(card);
      }
    });
  }

  window.onload = loadMenu;
</script>

</body>
</html>
