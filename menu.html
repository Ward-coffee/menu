
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <title>ูููู ูุฑุฏ ูุงููู</title>
  <!-- ุฃููููุฉ ุงููููุน -->
  <link rel="icon" href="photos/logo.png" type="image/x-icon">
  <!-- ููู ุงูุชุตููู  -->
  <link rel="stylesheet" href="style.css">
  <!-- ููู ุงููุงูููุณุช ุงูุฎุงุต ุจุงูุชุทุจูู -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#551665">

  <!-- ุฏุนู ุงูุชุซุจูุช ุนูู iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="photos/logo.png">

  <!-- ุฒุฑ ุงูุฑุฌูุน ููุตูุญุฉ ุงูุฑุฆูุณูุฉ - ุณุชุงูู ูุฏูุฌ ูุฅุธูุงุฑู ูุจุงุดุฑุฉ -->
  <style>
    /* ุฒุฑ ุงูุฑุฆูุณูุฉ */
    .home-btn {
      position: absolute;
      right: 12px;    /* ูุถุน ุงูุฒุฑ ูู ุงูุฌูุฉ ุงููููู (ูู RTL ูุฐู ูู ุงูุฒุงููุฉ ุงูุตุญูุญุฉ) */
      bottom: 12px;   /* ูุถุน ุงูุฒุฑ ูู ุงูุฃุณูู */
      display: inline-flex;
      gap: 8px;
      align-items: center;
      background: linear-gradient(135deg,#8E44AD 0%, #551665 100%);
      color: #fff;
      text-decoration: none;
      padding: 8px 12px;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(106,13,173,0.12);
      font-weight: 600;
      font-family: inherit;
      z-index: 50;
      border: 1px solid rgba(255,255,255,0.12);
      -webkit-tap-highlight-color: transparent;
      /* ุถูุงู ุฃู ุงููุต ูุงูุขูููู ูุชูุงุณุจุงู ูุน RTL */
      direction: rtl;
    }

    .home-btn svg { width:18px; height:18px; display:block; flex-shrink:0; }

    .home-btn span { font-size: 15px; line-height: 1; }

    .home-btn:active { transform: translateY(1px); }
    .home-btn:focus { outline: 3px solid rgba(138,81,201,0.16); outline-offset: 3px; }

    /* ุงุณุชุฌุงุจุฉ ุนูู ุงูุดุงุดุงุช ุงูุตุบูุฑุฉ */
    @media (max-width:480px) {
      .home-btn { right: 10px; bottom: 10px; padding: 8px 10px; border-radius:10px; }
      .home-btn span { font-size: 14px; }
      .home-btn svg { width:16px; height:16px; }
      .header { height: 200px; } /* ูุชูุงุดู ูุน ุชูููู ุงุฑุชูุงุน ุงูููุฏุฑ ุนูู ุงููุงุชู */
    }

    /* ูู ุญุงู ูุฌูุฏ conflict ูุน style.css ูุฑูุน z-index */
    .header { position: relative; overflow: hidden; }
  </style>
</head>

<body>
  <!-- ุฑุณุงูุฉ/ุฑุงุจุท ุทูุจ ุงูุฅุฐู ูุชุซุจูุช ุงูุชุทุจูู -->
  <div id="installPromptContainer" style="
      position: fixed;
      bottom: 20px;
      left: 20px;
      z-index: 9999;
      background-color: rgba(0, 0, 0, 0.7);
      padding: 6px 6px;
      border-radius: 10px;
      color: white;
      font-size: 14px;
      display: none;
    ">
    ูุฐุง ุงููููุน ูููู ุชุซุจูุชู ูุชุทุจูู ุนูู ุฌูุงุฒู.<br>
    <a href="#" id="installLink" style="
        color: #FFD700;
        text-decoration: underline;
        cursor: pointer;
      ">
      ุงุถุบุท ููุง ูุชุซุจูุช ุงูุชุทุจูู
    </a>
  </div>

  <!-- ููุงุญุธุฉ ุชุซุจูุช ุฎุงุตุฉ ุจู iOS -->
  <div id="iosInstallHint" style="
      display: none;
      position: fixed;
      bottom: 80px;
      left: 20px;
      z-index: 9999;
      background-color: rgba(0, 0, 0, 0.7);
      padding: 6px 6px;
      border-radius: 10px;
      color: white;
      font-size: 14px;
    ">
    ูุชุซุจูุช ุงูุชุทุจูู: ุงุถุบุท ุนูู ุฒุฑ <b>ุงููุดุงุฑูุฉ</b> ุซู ุงุฎุชุฑ <b>"ุฅุถุงูุฉ ุฅูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ"</b>.
  </div>

  <script>
    let deferredPrompt;
    const installPromptContainer = document.getElementById('installPromptContainer');
    const installLink = document.getElementById('installLink');

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      installPromptContainer.style.display = 'block';
    });

    installLink.addEventListener('click', (event) => {
      event.preventDefault();
      installPromptContainer.style.display = 'none';

      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('โ ุงููุณุชุฎุฏู ูุงูู ุนูู ุงูุชุซุจูุช');
          } else {
            console.log('โ ุงููุณุชุฎุฏู ุฑูุถ ุงูุชุซุจูุช');
          }
          deferredPrompt = null;
        });
      }
    });

    const isIOS = /iphone|ipad|ipod/.test(window.navigator.userAgent.toLowerCase());
    const isInStandaloneMode = ('standalone' in window.navigator) && window.navigator.standalone;

    if (isIOS && !isInStandaloneMode) {
      document.getElementById('iosInstallHint').style.display = 'block';
    }
  </script>

  <!-- ุจุฏุงูุฉ ูุญุชูู ุงูุตูุญุฉ -->
  <div class="page-frame">
    <!-- ุงูุดุฑูุท ุงูุนููู -->
    <div class="header" style="position: relative; height: 200px;">
      <img src="photos/logo.png" alt="Logo" class="logo-img">
      <div class="logo-text">
        ูุทุนู ููุงููู "ูุฑุฏ" ููุฏู ุชุฌุฑุจุฉ ุทุนุงู ุตุญูุฉ ูุดููุฉ ุจููููุงุช ุทุจูุนูุฉ ุทุงุฒุฌุฉ.
        ูุณุชุฎุฏู ุฒูุช ุงูุฒูุชูู ููุบุณู ุงูุฎุถุฑูุงุช ุจุนูุงูุฉ ูุถูุงู ูุธุงูุชูุง.
        ูุจุชุนุฏ ุนู ุงูููููุงุช ุงูุตูุงุนูุฉ ูุงูููุญ ุงูุตูููุ
        ููุนุชูุฏ ุฃุฏูุงุช ุทูู ุตุญูุฉ ููุนุงููุฑ ูุธุงูุฉ ุนุงูููุฉ.
        ุตูุฑ ุฃุทุจุงููุง ูุงูุนูุฉ ููุง ุชููุฏูููุ ูุฃู ุงูุฃูุงูุฉ ุชุจุฏุฃ ูู ุงููุทุจุฎ.
      </div>
    </div>

    <!-- ุดุฑูุท ุงูุจุญุซ -->
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="ุจุญุซ...">
      <button onclick="search()">๐</button>
    </div>

    <script>
      function search() {
        const query = document.getElementById('searchInput').value.trim();
        const container = document.getElementById('food-list');
        container.innerHTML = '';

        if (!query) {
          alert("ุงูุฑุฌุงุก ุฅุฏุฎุงู ูููุฉ ููุจุญุซ");
          return;
        }

        let resultsFound = false;
        const maxPrice = !isNaN(query) ? parseFloat(query) : null;

        for (const category in foodData) {
          foodData[category].forEach(item => {
            const itemName = item.name || "";
            const itemPrice = parseFloat(item.price) || 0;

            const matchesName = itemName.includes(query);
            const matchesPrice = maxPrice !== null && itemPrice <= maxPrice;

            if (matchesName || matchesPrice) {
              resultsFound = true;
              const card = document.createElement('div');
              card.className = 'food-card';
              card.innerHTML = `
                ${item.image ? `<img src="${item.image}" alt="${item.name}" onerror="this.style.display='none';">` : ""}
                <div class="food-info">
                  <h4>${item.price} <span>${item.name}</span></h4>
                  ${item.description ? `<p>${item.description}</p>` : ""}
                </div>
              `;
              container.appendChild(card);
            }
          });
        }

        if (!resultsFound) {
          container.innerHTML = `<p style="text-align:center; padding: 20px;">ูุง ุชูุฌุฏ ูุชุงุฆุฌ ุชุทุงุจู "${query}"</p>`;
        }
      }
    </script>

    <!-- ุงููุงุฆูุฉ ุงูุฃูููุฉ -->
    <!-- ุงููุงุฆูุฉ (ุดุจูุฉ ุงูุชุตูููุงุช) -->
    <div class="categories-grid">
      <button class="category selected">๐ฅ<br>ุงูุงูุทุงุฑ</button>
      <button class="category">๐ฅช<br>ุณุงูุฏููุชุด</button>
      <button class="category">๐<br>ุงูุจูุชุฒุง</button>
      <button class="category">๐ฑ<br>ุงูุณูุทุงุช</button>
      <button class="category">๐ฒ<br>ุงูุดูุฑุจุงุช</button>
      <button class="category">๐ฅจ<br>ุณูุงู</button>
      <button class="category">๐ฝ๏ธ<br>ุงูุงุทุจุงู</button>
      <button class="category">๐ฑ<br>ูุฌุจุงุช ุงูุฃุทูุงู</button>
      <button class="category">๐ฐ<br>ุงูุญูููุงุช ู ุงูุขูุณูุฑูู</button>
      <button class="category">๐ฅค<br>ุงููุดุฑูุจุงุช ุงูุจุงุฑุฏุฉ</button>
      <button class="category">โ๏ธ<br>ุงููุดุฑูุจุงุช ุงูุณุงุฎูุฉ</button>
      <button class="category">๐จ<br>ุงูุดูุด</button>
    </div>

    <!-- ูุณู ุงูุทุนุงู (ูุชู ููุคู ุฏููุงูููููุง) -->
    <div id="food-list"></div>

  <!-- ุฃุฒุฑุงุฑ ุงูุชููู ุงูุณูููุฉ -->
  <nav class="bottom-nav">
    <a href="fedback.html" aria-label="ุงูุดูุงูู ูุงูุงูุชุฑุงุญุงุช">
      <i class="fas fa-comment-dots"></i>
    </a>
    <a href="index.html" aria-label="ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ">
      <i class="fas fa-home"></i>
    </a>
    <a href="map.html" aria-label="ุตูุญุฉ ุงููููุน">
      <i class="fas fa-map-marker-alt"></i>
    </a>
  </nav>



  <!-- ุณูุฑุจุช ุนุฑุถ ุงูุจูุงูุงุช -->
 <script>
    // 1. ุชุนุฑูู ุงููุชุบูุฑุงุช ุงูุฃุณุงุณูุฉ
    let foodData = {}; 
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzwC1z6ekYGfMf6V7aWGZj5qPH2zhgIeE78EJlFriRfFpn9m8BTfJ1NrYqPGlJMZfEX/exec";

    // 2. ุฏุงูุฉ ุฌูุจ ุงูุจูุงูุงุช ูู Google Sheets
    async function fetchMenuData() {
        try {
            const response = await fetch(SCRIPT_URL);
            if (!response.ok) throw new Error("Network response was not ok");
            
            foodData = await response.json();
            
            // ุจุนุฏ ูุฌุงุญ ุงูุฌูุจุ ูุนุฑุถ ุฃูู ูุฆุฉ
            renderFoodItems("ุงูุงูุทุงุฑ");
        } catch (error) {
            console.error("ุฎุทุฃ ูู ุฌูุจ ุงูุจูุงูุงุช:", error);
            document.getElementById('food-list').innerHTML = 
                `<p style="text-align:center; padding:20px;">ุนุฐุฑุงูุ ุชุนุฐุฑ ุชุญุฏูุซ ุงููุงุฆูุฉ ุญุงููุงู. ูุฑุฌู ุงููุญุงููุฉ ูุงุญูุงู ๐</p>`;
        }
    }

    // 3. ุฏุงูุฉ ุนุฑุถ ุงูููุชุฌุงุช ุจูุงุกู ุนูู ุงูุชุตููู
    function renderFoodItems(category) {
      const container = document.getElementById('food-list');
      container.innerHTML = '';
      
      // ุงูุชุฃูุฏ ูู ูุฌูุฏ ุจูุงูุงุช ููุฐู ุงููุฆุฉ
      if (!foodData[category] || foodData[category].length === 0) {
          container.innerHTML = `<p style="text-align:center; padding: 20px;">ูุง ุชูุฌุฏ ุฃุตูุงู ูุชููุฑุฉ ูู ูุณู ${category} ุญุงููุงู.</p>`;
          return;
      }

      foodData[category].forEach(item => {
        const card = document.createElement('div');
        card.className = 'food-card';
        card.innerHTML = `
          ${item.image ? `<img src="${item.image}" alt="${item.name}" onerror="this.style.display='none';">` : ""}
          <div class="food-info">
            <h4>${item.price} <span>${item.name}</span></h4>
            ${item.description ? `<p>${item.description}</p>` : ""}
          </div>
        `;
        container.appendChild(card);
      });
    }

    // 4. ุฏุงูุฉ ุงูุจุญุซ ุงููุญุฏุซุฉ (ุชุจุญุซ ูู ุงูุจูุงูุงุช ุงููุฌููุจุฉ)
    function search() {
        const query = document.getElementById('searchInput').value.trim();
        const container = document.getElementById('food-list');
        container.innerHTML = '';

        if (!query) {
          renderFoodItems("ุงูุงูุทุงุฑ"); // ุงูุนูุฏุฉ ููุจุฏุงูุฉ ุนูุฏ ูุณุญ ุงูุจุญุซ
          return;
        }

        let resultsFound = false;
        const maxPrice = !isNaN(query) ? parseFloat(query) : null;

        for (const category in foodData) {
          foodData[category].forEach(item => {
            const itemName = item.name || "";
            const itemPrice = parseFloat(item.price) || 0;
            const matchesName = itemName.includes(query);
            const matchesPrice = maxPrice !== null && itemPrice <= maxPrice;

            if (matchesName || matchesPrice) {
              resultsFound = true;
              const card = document.createElement('div');
              card.className = 'food-card';
              card.innerHTML = `
                ${item.image ? `<img src="${item.image}" alt="${item.name}" onerror="this.style.display='none';">` : ""}
                <div class="food-info">
                  <h4>${item.price} <span>${item.name}</span></h4>
                </div>
              `;
              container.appendChild(card);
            }
          });
        }

        if (!resultsFound) {
          container.innerHTML = `<p style="text-align:center; padding: 20px;">ูุง ุชูุฌุฏ ูุชุงุฆุฌ ุชุทุงุจู "${query}"</p>`;
        }
    }

    // 5. ุฑุจุท ุฃุฒุฑุงุฑ ุงูุชุตูููุงุช
    document.querySelectorAll('.category').forEach(button => {
      button.addEventListener('click', () => {
        document.querySelectorAll('.category').forEach(btn => btn.classList.remove('selected'));
        button.classList.add('selected');
        const categoryText = button.innerText.trim().split('\n')[1];
        renderFoodItems(categoryText);
      });
    });

    // 6. ุชุดุบูู ุงูุฌูุจ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
    window.onload = () => {
        fetchMenuData();
    };

    // ุชุณุฌูู Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(err => console.error(err));
    }
  </script>
</body>
</html>





